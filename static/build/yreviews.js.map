{"version":3,"sources":["../src/yreviews.js"],"names":[],"mappings":"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","file":"yreviews.js","sourcesContent":["var Businesses = React.createClass({\n    getInitialState: function() {\n        return {data: []};\n    },\n    fetchData: function(api_url) {\n        $.ajax({\n            url: api_url,\n            dataType: 'json',\n            cache: false,\n            success: function(data) {\n                this.setState({data: data});\n            }.bind(this),\n            error: function(xhr, status, err) {\n                console.error(api_url, status, err.toString());\n            }.bind(this)\n        });  \n    },\n    componentDidMount: function() {\n        this.fetchData('/api/v1.0/businesses/');\n    },\n    render: function() {\n        var businessNodes = this.state.data.map(function(business){\n            return (\n                <Business icon_url={business.icon_url} name={business.name} id={\"#reviews/\"+business.id} url={business.url} /> \n            );\n        });\n        return (\n            <div className=\"row\">\n                <div className=\"col-md-12\"><h4>Select business</h4></div>\n                <div className=\"col-md-6\">\n                    <ul className=\"business-list list-group\">\n                        {businessNodes} \n                    </ul>\n                </div>\n            </div>\n        );\n    }\n});\n\nvar Business = React.createClass({\n    render: function() {\n        return (\n            <li className=\"business-item list-group-item\">\n                <a href={this.props.id}><img src={this.props.icon_url} alt={this.props.name} className=\"img-thumbnail\"/></a>\n                <h4 className=\"list-group-item-heading\"><a href={this.props.id}>{this.props.name}</a></h4>\n                <a className=\"btn btn-info\" href={this.props.url} target=\"_blank\">View business on Yelp</a>\n                <span className=\"clear\"></span>\n            </li>\n        );\n    }\n});\n\nvar Reviews = React.createClass({\n    getInitialState: function() {\n        return {data: []};\n    },\n    componentDidMount: function() {\n        drawPlot('/api/v1.0/reviews/'+this.props.location[1]+'/');\n    },\n    render: function() {\n        return (\n            <div className=\"row\">\n                <div className=\"col-md-12\">\n                    <a href=\"#\" className=\"btn btn-default\" aria-label=\"Left Align\">\n                        <span className=\"glyphicon glyphicon-chevron-left\" aria-hidden=\"true\"></span>\n                        back\n                    </a>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col-md-12\">\n                        <svg id=\"reviews-graph\"></svg>\n                    </div>\n                </div>\n            </div>    \n        );\n    }\n});\n\n/*\nfunction drawPlot(api_url) {\n    var margin = {top: 10, right: 10, bottom: 100, left: 40},\n        margin2 = {top: 430, right: 10, bottom: 20, left: 40},\n        width = 960 - margin.left - margin.right,\n        height = 500 - margin.top - margin.bottom,\n        height2 = 500 - margin2.top - margin2.bottom;\n    \n    \n    var x = d3.time.scale().range([0, width]),\n        x2 = d3.time.scale().range([0, width]),\n        y = d3.scale.linear().range([height, 0]),\n        y2 = d3.scale.linear().range([height2, 0]);\n\n    var xAxis = d3.svg.axis().scale(x).orient(\"bottom\"),\n        xAxis2 = d3.svg.axis().scale(x2).orient(\"bottom\"),\n        yAxis = d3.svg.axis().scale(y).orient(\"left\");\n\n    var brush = d3.svg.brush()\n        .x(x2)\n        .on(\"brush\", brushed);\n\n    var area = d3.svg.area()\n        .interpolate(\"monotone\")\n        .x(function(d) { return x(d3.time.format(\"%b %Y\").parse(d.date)); })\n        .y0(height)\n        .y1(function(d) { return y(d.rating); });\n\n    var area2 = d3.svg.area()\n        .interpolate(\"monotone\")\n        .x(function(d) { return x2(d3.time.format(\"%b %Y\").parse(d.date)); })\n        .y0(height2)\n        .y1(function(d) { return y2(d.rating); });\n    \n    var svg = d3.select(\"#reviews-graph\")\n        .attr(\"width\", width + margin.left + margin.right)\n        .attr(\"height\", height + margin.top + margin.bottom);\n\n    svg.append(\"defs\").append(\"clipPath\")\n        .attr(\"id\", \"clip\")\n        .append(\"rect\")\n        .attr(\"width\", width)\n        .attr(\"height\", height);\n\n    var focus = svg.append(\"g\")\n        .attr(\"class\", \"focus\")\n        .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    var context = svg.append(\"g\")\n        .attr(\"class\", \"context\")\n        .attr(\"transform\", \"translate(\" + margin2.left + \",\" + margin2.top + \")\");\n\n    d3.json(api_url, function(error, data) {\n        x.domain(d3.extent(data.map(function(d) { return d3.time.format(\"%b %Y\").parse(d.date); })));\n        y.domain([0, d3.max(data.map(function(d) { return +d.rating; }))]);\n        x2.domain(x.domain());\n        y2.domain(y.domain());\n\n    focus.append(\"path\")\n        .datum(data)\n        .attr(\"class\", \"area\")\n        .attr(\"d\", area);\n\n    focus.append(\"g\")\n        .attr(\"class\", \"x axis\")\n        .attr(\"transform\", \"translate(0,\" + height + \")\")\n        .call(xAxis);\n\n    focus.append(\"g\")\n        .attr(\"class\", \"y axis\")\n        .call(yAxis);\n    \n    context.append(\"path\")\n        .datum(data)\n        .attr(\"class\", \"area\")\n        .attr(\"d\", area2);\n\n    context.append(\"g\")\n        .attr(\"class\", \"x axis\")\n        .attr(\"transform\", \"translate(0,\" + height2 + \")\")\n        .call(xAxis2);\n\n    context.append(\"g\")\n        .attr(\"class\", \"x brush\")\n        .call(brush)\n        .selectAll(\"rect\")\n        .attr(\"y\", -6)\n        .attr(\"height\", height2 + 7);\n    });\n\n    function brushed() {\n        x.domain(brush.empty() ? x2.domain() : brush.extent());\n        focus.select(\".area\").attr(\"d\", area);\n        focus.select(\".x.axis\").call(xAxis);\n    }\n};\n*/\n\nfunction handleNewHash() {\n    var location = window.location.hash.replace(/^#\\/?|\\/$/g, '').split('/');\n    if (location[0] == '') {\n        var application = <Businesses location={location} />;\n    }\n    if (location[0] == 'reviews') {\n        var application = <Reviews location={location} />;\n    }\n    ReactDOM.render(\n        application,\n        document.getElementById('content')\n    );\n};\n\n\nfunction drawPlot(api_url) {\n    var margin = {top: 40, right: 20, bottom: 30, left: 40},\n    width = 960 - margin.left - margin.right,\n    height = 500 - margin.top - margin.bottom;\n\n    var formatPercent = d3.format(\".0%\");\n\n    var x = d3.scale.ordinal()\n        .rangeRoundBands([0, width], .1);\n\n    var y = d3.scale.linear()\n        .range([height, 0]);\n\n    var xAxis = d3.svg.axis()\n        .scale(x)\n        .orient(\"bottom\");\n\n    var yAxis = d3.svg.axis()\n        .scale(y)\n        .orient(\"left\")\n        .tickFormat(formatPercent);\n\n    var tip = d3.tip()\n      .attr('class', 'd3-tip')\n      .offset([-10, 0])\n      .html(function(d) {\n        return \"<strong>Frequency:</strong> <span style='color:red'>\" + d.frequency + \"</span>\";\n      })\n\n    var svg = d3.select(\"body\").append(\"svg\")\n        .attr(\"width\", width + margin.left + margin.right)\n        .attr(\"height\", height + margin.top + margin.bottom)\n      .append(\"g\")\n        .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    svg.call(tip);\n\n    d3.tsv(\"data.tsv\", type, function(error, data) {\n      x.domain(data.map(function(d) { return d.letter; }));\n      y.domain([0, d3.max(data, function(d) { return d.frequency; })]);\n\n      svg.append(\"g\")\n          .attr(\"class\", \"x axis\")\n          .attr(\"transform\", \"translate(0,\" + height + \")\")\n          .call(xAxis);\n\n      svg.append(\"g\")\n          .attr(\"class\", \"y axis\")\n          .call(yAxis)\n        .append(\"text\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", 6)\n          .attr(\"dy\", \".71em\")\n          .style(\"text-anchor\", \"end\")\n          .text(\"Frequency\");\n\n      svg.selectAll(\".bar\")\n          .data(data)\n        .enter().append(\"rect\")\n          .attr(\"class\", \"bar\")\n          .attr(\"x\", function(d) { return x(d.letter); })\n          .attr(\"width\", x.rangeBand())\n          .attr(\"y\", function(d) { return y(d.frequency); })\n          .attr(\"height\", function(d) { return height - y(d.frequency); })\n          .on('mouseover', tip.show)\n          .on('mouseout', tip.hide)\n\n    });\n\n    function type(d) {\n      d.frequency = +d.frequency;\n      return d;\n    }  \n};\n\nhandleNewHash()\nwindow.addEventListener('hashchange', handleNewHash, false);\n\n"]}